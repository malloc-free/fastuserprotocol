\hypertarget{tb__session_8c}{\section{src/tb\-\_\-session.c File Reference}
\label{tb__session_8c}\index{src/tb\-\_\-session.\-c@{src/tb\-\_\-session.\-c}}
}
{\ttfamily \#include \char`\"{}tb\-\_\-session.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tb\-\_\-epoll.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tb\-\_\-common.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tb\-\_\-protocol.\-h\char`\"{}}\\*
{\ttfamily \#include $<$assert.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$netinet/in.\-h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\-h$>$}\\*
{\ttfamily \#include $<$glib-\/2.\-0/glib.\-h$>$}\\*
{\ttfamily \#include $<$netdb.\-h$>$}\\*
{\ttfamily \#include $<$pthread.\-h$>$}\\*
{\ttfamily \#include $<$time.\-h$>$}\\*
Include dependency graph for tb\-\_\-session.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tb__session_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{tb__session_8c_a15863848d0188bcb5662d43156903241}{tb\-\_\-session\-\_\-add} (\hyperlink{structtb__session__list__t}{tb\-\_\-session\-\_\-list\-\_\-t} $\ast$list, \hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$session)
\begin{DoxyCompactList}\small\item\em Add a session to a list. \end{DoxyCompactList}\item 
\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$ \hyperlink{tb__session_8c_a10ad0196975eeca1e3469d05cdcc3758}{create\-\_\-session} (char $\ast$file\-\_\-name, struct sockaddr\-\_\-storage $\ast$o\-\_\-addr\-\_\-info)
\begin{DoxyCompactList}\small\item\em Create a session with a file name, sockaddr\-\_\-storage. \end{DoxyCompactList}\item 
\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$ \hyperlink{tb__session_8c_a3ae8d1d1ca5878cd9bab48098af09aae}{tb\-\_\-create\-\_\-session} ()
\begin{DoxyCompactList}\small\item\em Create a session. \end{DoxyCompactList}\item 
\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$ \hyperlink{tb__session_8c_a61071ac6ac1fac65754a394e190fc57d}{tb\-\_\-create\-\_\-session\-\_\-full} (char $\ast$addr, char $\ast$port, int sock\-\_\-type, unsigned int data\-\_\-size)
\begin{DoxyCompactList}\small\item\em Full version of create session. \end{DoxyCompactList}\item 
void \hyperlink{tb__session_8c_a478a71afc34cc2f15ffd5732b102d5ca}{tb\-\_\-destroy\-\_\-session} (\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$session)
\begin{DoxyCompactList}\small\item\em Free memory used for a session. \end{DoxyCompactList}\item 
int \hyperlink{tb__session_8c_ac07e93563e7b1e38af38e582e360ee02}{tb\-\_\-set\-\_\-addrinfo} (\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$session, int type)
\begin{DoxyCompactList}\small\item\em Set the addrinfo for the session. \end{DoxyCompactList}\item 
void \hyperlink{tb__session_8c_a388990e2adbda494ee660b923afbf2db}{tb\-\_\-print\-\_\-times} (\hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} $\ast$session)
\begin{DoxyCompactList}\small\item\em Print the times for a given session. \end{DoxyCompactList}\item 
gdsl\-\_\-element\-\_\-t \hyperlink{tb__session_8c_a45d4154769abcedc5989d6feeb106a5e}{allocate\-\_\-session} (void $\ast$data)
\begin{DoxyCompactList}\small\item\em Allocates memory for a session. \end{DoxyCompactList}\item 
void \hyperlink{tb__session_8c_a59019b05e88200313224bf2c77ae9c7a}{free\-\_\-session} (gdsl\-\_\-element\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Free memory for a session. \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{tb__session_8c_a61635f66121430da09247644cb1ba0f2}{get\-\_\-key\-\_\-value} (void $\ast$data)
\item 
gboolean \hyperlink{tb__session_8c_ac73265e0d989f9a9b1c1eeae3d290a09}{tb\-\_\-session\-\_\-equals} (gconstpointer a, gconstpointer b)
\begin{DoxyCompactList}\small\item\em Tests equality for sessions keys. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{tb__session_8c_a45d4154769abcedc5989d6feeb106a5e}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!allocate\-\_\-session@{allocate\-\_\-session}}
\index{allocate\-\_\-session@{allocate\-\_\-session}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{allocate\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}gdsl\-\_\-element\-\_\-t allocate\-\_\-session (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a45d4154769abcedc5989d6feeb106a5e}


Allocates memory for a session. 

Used by gdsl structures to allocate memory for a \hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} struct.

data This needs to be an instance of \hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} 

Definition at line 243 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a10ad0196975eeca1e3469d05cdcc3758}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!create\-\_\-session@{create\-\_\-session}}
\index{create\-\_\-session@{create\-\_\-session}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{create\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-session\-\_\-t}$\ast$ create\-\_\-session (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{file\-\_\-name, }
\item[{struct sockaddr\-\_\-storage $\ast$}]{o\-\_\-addr\-\_\-info}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a10ad0196975eeca1e3469d05cdcc3758}


Create a session with a file name, sockaddr\-\_\-storage. 



Definition at line 44 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a59019b05e88200313224bf2c77ae9c7a}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!free\-\_\-session@{free\-\_\-session}}
\index{free\-\_\-session@{free\-\_\-session}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{free\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}void free\-\_\-session (
\begin{DoxyParamCaption}
\item[{gdsl\-\_\-element\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a59019b05e88200313224bf2c77ae9c7a}


Free memory for a session. 



Definition at line 256 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a61635f66121430da09247644cb1ba0f2}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!get\-\_\-key\-\_\-value@{get\-\_\-key\-\_\-value}}
\index{get\-\_\-key\-\_\-value@{get\-\_\-key\-\_\-value}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{get\-\_\-key\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ get\-\_\-key\-\_\-value (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a61635f66121430da09247644cb1ba0f2}


Definition at line 266 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a3ae8d1d1ca5878cd9bab48098af09aae}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-create\-\_\-session@{tb\-\_\-create\-\_\-session}}
\index{tb\-\_\-create\-\_\-session@{tb\-\_\-create\-\_\-session}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-create\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-session\-\_\-t}$\ast$ tb\-\_\-create\-\_\-session (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a3ae8d1d1ca5878cd9bab48098af09aae}


Create a session. 

With this version of create\-\_\-session, the sockaddr\-\_\-storage is created, the file name is set to N\-U\-L\-L, addr\-\_\-info and hints are null. 

Definition at line 67 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a61071ac6ac1fac65754a394e190fc57d}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-create\-\_\-session\-\_\-full@{tb\-\_\-create\-\_\-session\-\_\-full}}
\index{tb\-\_\-create\-\_\-session\-\_\-full@{tb\-\_\-create\-\_\-session\-\_\-full}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-create\-\_\-session\-\_\-full}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tb\-\_\-session\-\_\-t}$\ast$ tb\-\_\-create\-\_\-session\-\_\-full (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{addr, }
\item[{char $\ast$}]{port, }
\item[{int}]{sock\-\_\-type, }
\item[{unsigned int}]{data\-\_\-size}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a61071ac6ac1fac65754a394e190fc57d}


Full version of create session. 

This version creates the hints and info field, and resolves the provided address. If the data\-\_\-size parameter is greater than zero, the session buffer is also created. 

Definition at line 100 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a478a71afc34cc2f15ffd5732b102d5ca}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-destroy\-\_\-session@{tb\-\_\-destroy\-\_\-session}}
\index{tb\-\_\-destroy\-\_\-session@{tb\-\_\-destroy\-\_\-session}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-destroy\-\_\-session}]{\setlength{\rightskip}{0pt plus 5cm}void tb\-\_\-destroy\-\_\-session (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-session\-\_\-t} $\ast$}]{session}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a478a71afc34cc2f15ffd5732b102d5ca}


Free memory used for a session. 

Frees memory used by a \hyperlink{structtb__session__t}{tb\-\_\-session\-\_\-t} struct. Releases all memory for associated fields. 

Definition at line 125 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a388990e2adbda494ee660b923afbf2db}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-print\-\_\-times@{tb\-\_\-print\-\_\-times}}
\index{tb\-\_\-print\-\_\-times@{tb\-\_\-print\-\_\-times}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-print\-\_\-times}]{\setlength{\rightskip}{0pt plus 5cm}void tb\-\_\-print\-\_\-times (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-session\-\_\-t} $\ast$}]{session}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_a388990e2adbda494ee660b923afbf2db}


Print the times for a given session. 

Prints to stdout the connection and transfer times for the given session.

\begin{DoxyPrecond}{Precondition}
The times in the session need to have been set, using the timer functions tb\-\_\-start\-\_\-time, tb\-\_\-finish\-\_\-time and tb\-\_\-calculate\-\_\-time 
\end{DoxyPrecond}

\begin{DoxyParams}{Parameters}
{\em session} & The session to print the times for. \\
\hline
\end{DoxyParams}


Definition at line 218 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_a15863848d0188bcb5662d43156903241}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-session\-\_\-add@{tb\-\_\-session\-\_\-add}}
\index{tb\-\_\-session\-\_\-add@{tb\-\_\-session\-\_\-add}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-session\-\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}void tb\-\_\-session\-\_\-add (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-session\-\_\-list\-\_\-t} $\ast$}]{list, }
\item[{{\bf tb\-\_\-session\-\_\-t} $\ast$}]{session}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{tb__session_8c_a15863848d0188bcb5662d43156903241}


Add a session to a list. 



Definition at line 25 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_ac73265e0d989f9a9b1c1eeae3d290a09}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-session\-\_\-equals@{tb\-\_\-session\-\_\-equals}}
\index{tb\-\_\-session\-\_\-equals@{tb\-\_\-session\-\_\-equals}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-session\-\_\-equals}]{\setlength{\rightskip}{0pt plus 5cm}gboolean tb\-\_\-session\-\_\-equals (
\begin{DoxyParamCaption}
\item[{gconstpointer}]{a, }
\item[{gconstpointer}]{b}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_ac73265e0d989f9a9b1c1eeae3d290a09}


Tests equality for sessions keys. 

Called by the hash table implementation in glib. Simply tests to see if the supplied integers are equal (these are just int32). 

Definition at line 289 of file tb\-\_\-session.\-c.

\hypertarget{tb__session_8c_ac07e93563e7b1e38af38e582e360ee02}{\index{tb\-\_\-session.\-c@{tb\-\_\-session.\-c}!tb\-\_\-set\-\_\-addrinfo@{tb\-\_\-set\-\_\-addrinfo}}
\index{tb\-\_\-set\-\_\-addrinfo@{tb\-\_\-set\-\_\-addrinfo}!tb_session.c@{tb\-\_\-session.\-c}}
\subsubsection[{tb\-\_\-set\-\_\-addrinfo}]{\setlength{\rightskip}{0pt plus 5cm}int tb\-\_\-set\-\_\-addrinfo (
\begin{DoxyParamCaption}
\item[{{\bf tb\-\_\-session\-\_\-t} $\ast$}]{session, }
\item[{int}]{type}
\end{DoxyParamCaption}
)}}\label{tb__session_8c_ac07e93563e7b1e38af38e582e360ee02}


Set the addrinfo for the session. 

Fills out the addrinfo field for the session. 

Definition at line 185 of file tb\-\_\-session.\-c.

